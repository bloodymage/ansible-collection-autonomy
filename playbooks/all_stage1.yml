# ==================================================================================================
#
# First we gather some information
#
# ==================================================================================================
- hosts: all:!public_zone
  ignore_unreachable: yes
  roles:
    - bloodymage.rebeldream.config_environment

# ==================================================================================================
#
# Next we configure setting applicable to ALL hosts
#
# ==================================================================================================
- hosts: all:!localhost:!tpeap:!printers:!public_zone
  strategy: linear
  roles:
    - role: bloodymage.rebeldream.hostname
    - role: bloodymage.rebeldream.hosts
    - role: bloodymage.rebeldream.system_upgrade
    - role: bloodymage.rebeldream.users

# ==================================================================================================
#
# Next we configure settings applicable based on OS:
#   - Linux
#   - Windows
#
# ==================================================================================================
- hosts: linux:!localhost:!routeros:!tpeap:!printers:!public_zone
  strategy: linear
  roles:
    - role: bloodymage.rebeldream.sshca_host_certs
    - role: bloodymage.rebeldream.openssh
      tags:
        - openssh
    - role: bloodymage.rebeldream.ntp
    - role: bloodymage.rebeldream.unattended_upgrades
      tags:
        - unattended-upgrades
    - role: bloodymage.rebeldream.global_packages
    - role: bloodymage.rebeldream.sudo
    - role: bloodymage.rebeldream.skel
    - role: bloodymage.rebeldream.dotfiles
    - role: bloodymage.rebeldream.etckeeper
    - role: bloodymage.rebeldream.polkit
    - role: bloodymage.rebeldream.screen
    - role: bloodymage.rebeldream.rsync
      tags:
        - rsync
    - role: bloodymage.rebeldream.fail2ban
      tags:
        - fail2ban
    - role: bloodymage.rebeldream.curl
      tags:
        - curl
    - role: bloodymage.rebeldream.git
      tags:
        - git
    - role: bloodymage.rebeldream.keychain
      tags:
        - keychain
    - role: bloodymage.rebeldream.man
      tags:
        - man

# ==================================================================================================
#
# Finally, we configure settings based on OS Distribution Family:
#
# - Debian
#
# ==================================================================================================
- hosts: debian:!localhost:!routeros:!tpeap:!printers:!public_zone
  roles:
    - role: bloodymage.rebeldream.aptitude
