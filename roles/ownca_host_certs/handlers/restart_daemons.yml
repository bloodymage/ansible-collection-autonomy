- name: Update System CA Certificates
  command: "update-ca-certificates"
  become: yes
  tags:
    - ownca-host-certs

- name: Restart Apache
  service:
    name: apache2
    state: restarted
  when:
    - inventory_hostname in groups['apache_servers'] | default([])
  tags:
    - ownca-host-certs

- name: Restart Bind9
  service:
    name: bind9
    state: restarted
  when:
    - inventory_hostname in groups['dns_servers'] | default([])
  tags:
    - ownca-host-certs

- name: Restart Dovecot
  service:
    name: dovecot
    state: restarted
  when:
    - inventory_hostname in groups['dovecot_servers'] | default([])
  tags:
    - ownca-host-certs

- name: Restart Mosquitto
  service:
    name: mosquitto
    state: restarted
  when:
    - inventory_hostname in groups['mosquitto_servers'] | default([])
  tags:
    - ownca-host-certs

- name: Restart MySQL
  service:
    name: mysql
    state: restarted
  when:
    - inventory_hostname in groups ['mysql_compatable_servers'] | default([])
  tags:
    - ownca-host-certs

- name: Restart Postfix
  service:
    name: postfix
    state: restarted
  when:
    - inventory_hostname in groups['postfix_servers'] | default([])
  tags:
    - ownca-host-certs

- name: Restart Samba Domain Controller
  service:
    name: samba-ad-dc
    state: restarted
  when:
    - inventory_hostname in groups['samba_domain_controllers'] | default([])
  tags:
    - ownca-host-certs
